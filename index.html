<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EnergiX - Smart Energy Calculator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #10b981;
            --primary-dark: #059669;
            --secondary: #3b82f6;
            --dark: #1e293b;
            --darker: #0f172a;
            --light: #f1f5f9;
            --gray: #64748b;
            --success: #22c55e;
            --warning: #f59e0b;
            --danger: #ef4444;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 100%);
            min-height: 100vh;
            color: var(--light);
        }

        /* Container */
        .app-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        /* Header */
        .app-header {
            text-align: center;
            padding: 30px 0;
        }

        .logo {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .tagline {
            color: var(--gray);
            margin-top: 8px;
            font-size: 0.95rem;
        }

        /* Progress Bar */
        .progress-container {
            margin: 30px 0;
        }

        .progress-bar {
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .step-circle {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .step-circle.active {
            background: var(--primary);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
        }

        .step-circle.completed {
            background: var(--success);
        }

        .step-label {
            font-size: 0.7rem;
            color: var(--gray);
            text-align: center;
            max-width: 60px;
        }

        /* Card Styles */
        .card {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title i {
            color: var(--primary);
        }

        .card-subtitle {
            color: var(--gray);
            margin-bottom: 25px;
            font-size: 0.95rem;
        }

        /* AI Chat Bubble */
        .ai-bubble {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(59, 130, 246, 0.2));
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 25px;
            position: relative;
        }

        .ai-bubble::before {
            content: 'ðŸ¤–';
            position: absolute;
            top: -15px;
            left: 20px;
            background: var(--dark);
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 1.2rem;
        }

        .ai-bubble p {
            line-height: 1.6;
        }

        .typing-indicator {
            display: flex;
            gap: 5px;
            padding: 10px 0;
        }

        .typing-indicator span {
            width: 8px;
            height: 8px;
            background: var(--primary);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--light);
        }

        .form-input, .form-select {
            width: 100%;
            padding: 15px 20px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            color: var(--light);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.2);
        }

        .form-select option {
            background: var(--dark);
            color: var(--light);
        }

        /* House Type Selection */
        .house-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .house-option {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .house-option:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
        }

        .house-option.selected {
            border-color: var(--primary);
            background: rgba(16, 185, 129, 0.1);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.2);
        }

        .house-option i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .house-option span {
            display: block;
            font-size: 0.85rem;
        }

        /* Room Navigation */
        .room-tabs {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding-bottom: 10px;
            margin-bottom: 25px;
        }

        .room-tab {
            padding: 12px 20px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 25px;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .room-tab:hover {
            border-color: var(--primary);
        }

        .room-tab.active {
            background: var(--primary);
            border-color: var(--primary);
        }

        .room-tab.completed {
            background: rgba(34, 197, 94, 0.2);
            border-color: var(--success);
        }

        .room-tab.completed::after {
            content: ' âœ“';
        }

        /* Equipment Card */
        .equipment-card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .equipment-card:hover {
            border-color: rgba(255,255,255,0.2);
        }

        .equipment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .equipment-name {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }

        .equipment-name i {
            color: var(--primary);
            font-size: 1.2rem;
        }

        .equipment-toggle {
            width: 50px;
            height: 26px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .equipment-toggle.active {
            background: var(--primary);
        }

        .equipment-toggle::after {
            content: '';
            position: absolute;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: all 0.3s ease;
        }

        .equipment-toggle.active::after {
            left: 26px;
        }

        .equipment-details {
            display: none;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .equipment-details.show {
            display: grid;
        }

        .detail-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .detail-label {
            font-size: 0.8rem;
            color: var(--gray);
        }

        .detail-input, .detail-select {
            padding: 10px 12px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            color: var(--light);
            font-size: 0.9rem;
        }

        .detail-input:focus, .detail-select:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* Wattage Auto-display */
        .wattage-display {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(59, 130, 246, 0.1));
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 10px;
            padding: 12px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
        }

        .wattage-label {
            font-size: 0.85rem;
            color: var(--gray);
        }

        .wattage-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary);
        }

        /* Usage Time Selection */
        .usage-time-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .time-option {
            padding: 15px 10px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .time-option:hover {
            border-color: var(--primary);
        }

        .time-option.selected {
            border-color: var(--primary);
            background: rgba(16, 185, 129, 0.15);
        }

        .time-option i {
            font-size: 1.5rem;
            margin-bottom: 8px;
            display: block;
        }

        .time-option.morning i { color: #fbbf24; }
        .time-option.afternoon i { color: #f97316; }
        .time-option.evening i { color: #8b5cf6; }
        .time-option.night i { color: #3b82f6; }

        .time-option span {
            font-size: 0.8rem;
        }

        /* Quantity Stepper */
        .quantity-stepper {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stepper-btn {
            width: 35px;
            height: 35px;
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            border: none;
            color: var(--light);
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .stepper-btn:hover {
            background: var(--primary);
        }

        .stepper-value {
            font-size: 1.1rem;
            font-weight: 600;
            min-width: 30px;
            text-align: center;
        }

        /* Hours Slider */
        .hours-slider {
            width: 100%;
            margin-top: 10px;
        }

        .slider-container {
            position: relative;
            padding: 10px 0;
        }

        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            outline: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.75rem;
            color: var(--gray);
        }

        /* Analysis Dashboard */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 1.5rem;
        }

        .stat-icon.primary { background: rgba(16, 185, 129, 0.2); color: var(--primary); }
        .stat-icon.warning { background: rgba(245, 158, 11, 0.2); color: var(--warning); }
        .stat-icon.danger { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        .stat-icon.secondary { background: rgba(59, 130, 246, 0.2); color: var(--secondary); }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--gray);
        }

        /* Consumption Breakdown Chart */
        .breakdown-chart {
            background: rgba(255,255,255,0.03);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }

        .chart-title {
            font-size: 1.1rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart-title i {
            color: var(--primary);
        }

        .breakdown-item {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .breakdown-icon {
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .breakdown-info {
            flex: 1;
        }

        .breakdown-name {
            font-size: 0.9rem;
            margin-bottom: 5px;
        }

        .breakdown-bar {
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .breakdown-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .breakdown-value {
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 80px;
            text-align: right;
        }

        /* Solar Recommendation */
        .solar-card {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(59, 130, 246, 0.1));
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 20px;
            padding: 25px;
            margin-top: 20px;
        }

        .solar-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .solar-icon {
            width: 60px;
            height: 60px;
            background: rgba(16, 185, 129, 0.2);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .solar-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .solar-subtitle {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .solar-specs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .spec-item {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
        }

        .spec-value {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary);
        }

        .spec-label {
            font-size: 0.8rem;
            color: var(--gray);
            margin-top: 5px;
        }

        /* Buttons */
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: var(--light);
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.15);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        /* Add Equipment Button */
        .add-equipment-btn {
            width: 100%;
            padding: 20px;
            background: rgba(255,255,255,0.03);
            border: 2px dashed rgba(255,255,255,0.1);
            border-radius: 15px;
            color: var(--gray);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .add-equipment-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        /* Step Visibility */
        .step-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .step-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Responsive */
        @media (max-width: 600px) {
            .app-container {
                padding: 15px;
            }

            .card {
                padding: 20px;
            }

            .house-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .usage-time-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .btn-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .progress-steps {
                display: none;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.05);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255,255,255,0.3);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1 class="logo">âš¡ EnergiX</h1>
            <p class="tagline">AI-Powered Energy Intelligence Platform</p>
        </header>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 14.28%;"></div>
            </div>
            <div class="progress-steps">
                <div class="progress-step">
                    <div class="step-circle active" data-step="1">1</div>
                    <span class="step-label">House</span>
                </div>
                <div class="progress-step">
                    <div class="step-circle" data-step="2">2</div>
                    <span class="step-label">Equipment</span>
                </div>
                <div class="progress-step">
                    <div class="step-circle" data-step="3">3</div>
                    <span class="step-label">Usage</span>
                </div>
                <div class="progress-step">
                    <div class="step-circle" data-step="4">4</div>
                    <span class="step-label">Analysis</span>
                </div>
                <div class="progress-step">
                    <div class="step-circle" data-step="5">5</div>
                    <span class="step-label">Location</span>
                </div>
                <div class="progress-step">
                    <div class="step-circle" data-step="6">6</div>
                    <span class="step-label">Solar</span>
                </div>
                <div class="progress-step">
                    <div class="step-circle" data-step="7">7</div>
                    <span class="step-label">Report</span>
                </div>
            </div>
        </div>

        <!-- STEP 1: House Type -->
        <div class="step-content active" id="step1">
            <div class="card">
                <div class="ai-bubble">
                    <p>ðŸ‘‹ Welcome! I'm your energy assistant. Let's discover your home's energy profile together. First, tell me about your home - this helps me understand your potential energy needs.</p>
                </div>

                <h2 class="card-title"><i class="fas fa-home"></i> What type of home do you live in?</h2>
                <p class="card-subtitle">Select the option that best describes your living space</p>

                <div class="house-grid house-options-container">
                    <div class="house-option" data-value="self-contain">
                        <i class="fas fa-door-open"></i>
                        <span>Self Contain</span>
                    </div>
                    <div class="house-option" data-value="1-room-parlor">
                        <i class="fas fa-couch"></i>
                        <span>1 Room & Parlor</span>
                    </div>
                    <div class="house-option" data-value="2-bedroom">
                        <i class="fas fa-bed"></i>
                        <span>2 Bedroom Flat</span>
                    </div>
                    <div class="house-option" data-value="3-bedroom">
                        <i class="fas fa-house-user"></i>
                        <span>3 Bedroom Flat</span>
                    </div>
                    <div class="house-option" data-value="4-bedroom">
                        <i class="fas fa-building"></i>
                        <span>4 Bedroom</span>
                    </div>
                    <div class="house-option" data-value="duplex">
                        <i class="fas fa-city"></i>
                        <span>Duplex</span>
                    </div>
                    <div class="house-option" data-value="bungalow">
                        <i class="fas fa-warehouse"></i>
                        <span>Bungalow</span>
                    </div>
                    <div class="house-option" data-value="office">
                        <i class="fas fa-briefcase"></i>
                        <span>Office Space</span>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="nextStep(2)">
                        Continue <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- STEP 2: Equipment Selection -->
        <div class="step-content" id="step2">
            <div class="card">
                <div class="ai-bubble">
                    <p>Great! Now let's go room by room and identify the electrical equipment you use. I'll help estimate the power consumption for each item based on typical ratings. Toggle on the equipment you have!</p>
                </div>

                <h2 class="card-title"><i class="fas fa-plug"></i> Your Equipment</h2>
                <p class="card-subtitle">Select equipment in each room and I'll calculate the power rating</p>

                <!-- Room Tabs -->
                <div class="room-tabs">
                    <div class="room-tab active" data-room="living">Living Room</div>
                    <div class="room-tab" data-room="bedroom">Bedroom(s)</div>
                    <div class="room-tab" data-room="kitchen">Kitchen</div>
                    <div class="room-tab" data-room="bathroom">Bathroom</div>
                    <div class="room-tab" data-room="general">General</div>
                </div>

                <!-- ============================================ -->
                <!-- LIVING ROOM EQUIPMENT -->
                <!-- ============================================ -->
                <div class="room-content active" id="room-living">
                    <!-- TV Equipment Card -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-tv"></i>
                                <span>Television</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Brand</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Brand</option>
                                    <option value="samsung">Samsung</option>
                                    <option value="lg">LG</option>
                                    <option value="sony">Sony</option>
                                    <option value="hisense">Hisense</option>
                                    <option value="tcl">TCL</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Size</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Size</option>
                                    <option value="32">32 inches</option>
                                    <option value="43">43 inches</option>
                                    <option value="50">50 inches</option>
                                    <option value="55">55 inches</option>
                                    <option value="65">65 inches</option>
                                    <option value="75">75+ inches</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Type</option>
                                    <option value="led">LED</option>
                                    <option value="oled">OLED</option>
                                    <option value="qled">QLED</option>
                                    <option value="smart">Smart TV</option>
                                    <option value="plasma">Plasma</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">-- W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Fan Equipment Card -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-fan"></i>
                                <span>Ceiling/Standing Fan</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Type</option>
                                    <option value="ceiling">Ceiling Fan</option>
                                    <option value="standing">Standing Fan</option>
                                    <option value="table">Table Fan</option>
                                    <option value="exhaust">Exhaust Fan</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">-- W</span>
                            </div>
                        </div>
                    </div>

                    <!-- AC Equipment Card -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-snowflake"></i>
                                <span>Air Conditioner</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Type</option>
                                    <option value="split">Split Unit</option>
                                    <option value="window">Window Unit</option>
                                    <option value="portable">Portable</option>
                                    <option value="inverter">Inverter AC</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Capacity</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Size</option>
                                    <option value="1">1 HP</option>
                                    <option value="1.5">1.5 HP</option>
                                    <option value="2">2 HP</option>
                                    <option value="2.5">2.5 HP</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">-- W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Light Bulbs -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-lightbulb"></i>
                                <span>Light Bulbs</span>
                            </div>
                            <div class="equipment-toggle active" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details show">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="led">LED Bulb</option>
                                    <option value="energy-saving">Energy Saving</option>
                                    <option value="incandescent">Incandescent</option>
                                    <option value="fluorescent">Fluorescent</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Wattage</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="5">5W</option>
                                    <option value="9" selected>9W</option>
                                    <option value="12">12W</option>
                                    <option value="15">15W</option>
                                    <option value="20">20W</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">4</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Total Power Rating</span>
                                <span class="wattage-value">36 W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Decoder/Cable Box -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-satellite-dish"></i>
                                <span>Decoder/Cable Box</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Type</option>
                                    <option value="dstv">DSTV</option>
                                    <option value="gotv">GOTV</option>
                                    <option value="startimes">StarTimes</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">25 W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Add Custom Equipment Button -->
                    <button class="add-equipment-btn" type="button">
                        <i class="fas fa-plus"></i>
                        Add Custom Equipment
                    </button>
                </div>

                <!-- ============================================ -->
                <!-- BEDROOM EQUIPMENT -->
                <!-- ============================================ -->
                <div class="room-content" id="room-bedroom">
                    <!-- Bedroom AC -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-snowflake"></i>
                                <span>Air Conditioner</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Type</option>
                                    <option value="split">Split Unit</option>
                                    <option value="window">Window Unit</option>
                                    <option value="portable">Portable</option>
                                    <option value="inverter">Inverter AC</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Capacity</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Size</option>
                                    <option value="1">1 HP</option>
                                    <option value="1.5">1.5 HP</option>
                                    <option value="2">2 HP</option>
                                    <option value="2.5">2.5 HP</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">-- W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Bedroom Fan -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-fan"></i>
                                <span>Ceiling/Standing Fan</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Type</option>
                                    <option value="ceiling">Ceiling Fan</option>
                                    <option value="standing">Standing Fan</option>
                                    <option value="table">Table Fan</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">2</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">-- W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Bedroom Light Bulbs -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-lightbulb"></i>
                                <span>Light Bulbs</span>
                            </div>
                            <div class="equipment-toggle active" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details show">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="led">LED Bulb</option>
                                    <option value="energy-saving">Energy Saving</option>
                                    <option value="incandescent">Incandescent</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Wattage</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="5">5W</option>
                                    <option value="9" selected>9W</option>
                                    <option value="12">12W</option>
                                    <option value="15">15W</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">3</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Total Power Rating</span>
                                <span class="wattage-value">27 W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Bedroom TV -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-tv"></i>
                                <span>Television</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Brand</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Brand</option>
                                    <option value="samsung">Samsung</option>
                                    <option value="lg">LG</option>
                                    <option value="sony">Sony</option>
                                    <option value="hisense">Hisense</option>
                                    <option value="tcl">TCL</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Size</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Size</option>
                                    <option value="32">32 inches</option>
                                    <option value="43">43 inches</option>
                                    <option value="55">55 inches</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Type</option>
                                    <option value="led">LED</option>
                                    <option value="smart">Smart TV</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">-- W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Phone Chargers -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-mobile-alt"></i>
                                <span>Phone Charger</span>
                            </div>
                            <div class="equipment-toggle active" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details show">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="standard">Standard (5W)</option>
                                    <option value="fast">Fast Charger (18W)</option>
                                    <option value="super-fast">Super Fast (45W)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">2</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">10 W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Laptop -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-laptop"></i>
                                <span>Laptop</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Type</option>
                                    <option value="ultrabook">Ultrabook (45W)</option>
                                    <option value="standard">Standard (65W)</option>
                                    <option value="gaming">Gaming Laptop (150W)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">65 W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Add Custom Equipment Button -->
                    <button class="add-equipment-btn" type="button">
                        <i class="fas fa-plus"></i>
                        Add Bedroom Equipment
                    </button>
                </div>

                <!-- ============================================ -->
                <!-- KITCHEN EQUIPMENT -->
                <!-- ============================================ -->
                <div class="room-content" id="room-kitchen">
                    <!-- Refrigerator -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-snowflake"></i>
                                <span>Refrigerator</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Type</option>
                                    <option value="single-door">Single Door</option>
                                    <option value="double-door">Double Door</option>
                                    <option value="side-by-side">Side by Side</option>
                                    <option value="mini">Mini Fridge</option>
                                    <option value="inverter">Inverter Fridge</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Size Litres</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Size</option>
                                    <option value="100">Under 100L</option>
                                    <option value="200">100-200L</option>
                                    <option value="300">200-300L</option>
                                    <option value="400">300-400L</option>
                                    <option value="500">400L+</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">-- W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Freezer -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-temperature-low"></i>
                                <span>Freezer</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Type</option>
                                    <option value="chest">Chest Freezer</option>
                                    <option value="upright">Upright Freezer</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Size</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Size</option>
                                    <option value="small">Small (100-200L)</option>
                                    <option value="medium">Medium (200-300L)</option>
                                    <option value="large">Large (300L+)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">150 W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Microwave -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-broadcast-tower"></i>
                                <span>Microwave</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Size</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Size</option>
                                    <option value="small">Small (20L)</option>
                                    <option value="medium">Medium (25-30L)</option>
                                    <option value="large">Large (30L+)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">-- W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Electric Kettle -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-coffee"></i>
                                <span>Electric Kettle</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Size</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Size</option>
                                    <option value="small">Small (1L)</option>
                                    <option value="medium">Medium (1.5L)</option>
                                    <option value="large">Large (2L+)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">1,800 W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Blender -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-blender"></i>
                                <span>Blender</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Size</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Size</option>
                                    <option value="small">Small (300W)</option>
                                    <option value="medium">Medium (500W)</option>
                                    <option value="large">Large/Commercial (800W+)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">-- W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Electric Cooker/Hot Plate -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-fire"></i>
                                <span>Electric Cooker/Hot Plate</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Type</option>
                                    <option value="single">Single Burner (1000W)</option>
                                    <option value="double">Double Burner (2000W)</option>
                                    <option value="induction">Induction Cooker (1800W)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">-- W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Kitchen Light -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-lightbulb"></i>
                                <span>Kitchen Light</span>
                            </div>
                            <div class="equipment-toggle active" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details show">
                            <div class="detail-group">
                                <label class="detail-label">Wattage</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="9">9W LED</option>
                                    <option value="12">12W LED</option>
                                    <option value="15">15W LED</option>
                                    <option value="20">20W LED</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">2</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Total Power Rating</span>
                                <span class="wattage-value">18 W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Add Custom Equipment Button -->
                    <button class="add-equipment-btn" type="button">
                        <i class="fas fa-plus"></i>
                        Add Kitchen Appliance
                    </button>
                </div>

                <!-- ============================================ -->
                <!-- BATHROOM EQUIPMENT -->
                <!-- ============================================ -->
                <div class="room-content" id="room-bathroom">
                    <!-- Water Heater -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-hot-tub"></i>
                                <span>Water Heater</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Type</option>
                                    <option value="instant">Instant Heater (3000W)</option>
                                    <option value="storage-25">Storage 25L (1500W)</option>
                                    <option value="storage-50">Storage 50L (2000W)</option>
                                    <option value="storage-100">Storage 100L (3000W)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">-- W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Exhaust Fan -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-fan"></i>
                                <span>Exhaust Fan</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Size</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Size</option>
                                    <option value="6">6 inch (25W)</option>
                                    <option value="8">8 inch (35W)</option>
                                    <option value="10">10 inch (40W)</option>
                                    <option value="12">12 inch (50W)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">40 W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Bathroom Light -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-lightbulb"></i>
                                <span>Bathroom Light</span>
                            </div>
                            <div class="equipment-toggle active" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details show">
                            <div class="detail-group">
                                <label class="detail-label">Wattage</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="5">5W LED</option>
                                    <option value="9" selected>9W LED</option>
                                    <option value="12">12W LED</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Total Power Rating</span>
                                <span class="wattage-value">9 W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Hair Dryer -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-wind"></i>
                                <span>Hair Dryer</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Type</option>
                                    <option value="travel">Travel Size (1000W)</option>
                                    <option value="standard">Standard (1500W)</option>
                                    <option value="professional">Professional (2000W)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">-- W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Add Custom Equipment Button -->
                    <button class="add-equipment-btn" type="button">
                        <i class="fas fa-plus"></i>
                        Add Bathroom Equipment
                    </button>
                </div>

                <!-- ============================================ -->
                <!-- GENERAL/OUTDOOR EQUIPMENT -->
                <!-- ============================================ -->
                <div class="room-content" id="room-general">
                    <!-- Water Pump -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-tint"></i>
                                <span>Water Pump</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Horsepower</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Size</option>
                                    <option value="0.5hp">0.5 HP (370W)</option>
                                    <option value="1hp">1 HP (750W)</option>
                                    <option value="1.5hp">1.5 HP (1100W)</option>
                                    <option value="2hp">2 HP (1500W)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">-- W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Security/Flood Light -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-lightbulb"></i>
                                <span>Security/Flood Light</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Wattage</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Wattage</option>
                                    <option value="20">20W LED</option>
                                    <option value="30">30W LED</option>
                                    <option value="50">50W LED</option>
                                    <option value="100">100W LED</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">2</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Total Power Rating</span>
                                <span class="wattage-value">60 W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Iron -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-fire-alt"></i>
                                <span>Pressing Iron</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Type</option>
                                    <option value="dry">Dry Iron (1000W)</option>
                                    <option value="steam">Steam Iron (1400W)</option>
                                    <option value="cordless">Cordless Iron (1800W)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">-- W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Washing Machine -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-tshirt"></i>
                                <span>Washing Machine</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Type</option>
                                    <option value="top-load">Top Load</option>
                                    <option value="front-load">Front Load</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Load Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Load</option>
                                    <option value="manual">Manual (350W)</option>
                                    <option value="automatic">Automatic (500W)</option>
                                    <option value="inverter">Inverter (300W)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">-- W</span>
                            </div>
                        </div>
                    </div>

                    <!-- WiFi Router -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-wifi"></i>
                                <span>WiFi Router</span>
                            </div>
                            <div class="equipment-toggle active" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details show">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="standard">Standard Router (12W)</option>
                                    <option value="mesh">Mesh System (15W)</option>
                                    <option value="gaming">Gaming Router (20W)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">12 W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Desktop Computer -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-desktop"></i>
                                <span>Desktop Computer</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Type</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Type</option>
                                    <option value="basic">Basic/Office (150W)</option>
                                    <option value="standard">Standard (250W)</option>
                                    <option value="gaming">Gaming PC (500W)</option>
                                    <option value="workstation">Workstation (750W)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Monitor</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Select Monitor</option>
                                    <option value="19">19" LCD (25W)</option>
                                    <option value="24">24" LED (30W)</option>
                                    <option value="27">27" LED (40W)</option>
                                    <option value="32">32"+ LED (60W)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">250 W</span>
                            </div>
                        </div>
                    </div>

                    <!-- CCTV/Security System -->
                    <div class="equipment-card">
                        <div class="equipment-header">
                            <div class="equipment-name">
                                <i class="fas fa-video"></i>
                                <span>CCTV/Security System</span>
                            </div>
                            <div class="equipment-toggle" onclick="toggleEquipment(this)"></div>
                        </div>
                        <div class="equipment-details">
                            <div class="detail-group">
                                <label class="detail-label">Cameras</label>
                                <select class="detail-select" onchange="updateWattage(this)">
                                    <option value="">Number of Cameras</option>
                                    <option value="2">2 Cameras (20W)</option>
                                    <option value="4">4 Cameras (35W)</option>
                                    <option value="8">8 Cameras (60W)</option>
                                    <option value="16">16 Cameras (100W)</option>
                                </select>
                            </div>
                            <div class="detail-group">
                                <label class="detail-label">Quantity</label>
                                <div class="quantity-stepper">
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                                    <span class="stepper-value">1</span>
                                    <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                                </div>
                            </div>
                            <div class="wattage-display" style="grid-column: 1 / -1;">
                                <span class="wattage-label">Estimated Power Rating</span>
                                <span class="wattage-value">-- W</span>
                            </div>
                        </div>
                    </div>

                    <!-- Add Custom Equipment Button -->
                    <button class="add-equipment-btn" type="button">
                        <i class="fas fa-plus"></i>
                        Add Other Equipment
                    </button>
                </div>

                <!-- Navigation Buttons -->
                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="nextStep(1)">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <button class="btn btn-primary" onclick="nextStep(3)">
                        Continue to Usage <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- STEP 3: Usage Patterns -->
        <div class="step-content" id="step3">
            <div class="card">
                <div class="ai-bubble">
                    <p>Excellent! Now I need to understand when and how long you use each equipment. This helps me calculate your peak consumption hours and estimate accurate energy costs.</p>
                </div>

                <h2 class="card-title"><i class="fas fa-clock"></i> Usage Patterns</h2>
                <p class="card-subtitle">Tell me when you typically use each equipment</p>

                <!-- Equipment Usage Pattern -->
                <div class="equipment-card">
                    <div class="equipment-header">
                        <div class="equipment-name">
                            <i class="fas fa-tv"></i>
                            <span>Television (Samsung 55" Smart TV)</span>
                        </div>
                        <span class="wattage-value">120 W</span>
                    </div>

                    <div class="form-group">
                        <label class="form-label">When do you typically use this?</label>
                        <div class="usage-time-grid">
                            <div class="time-option morning" onclick="toggleTimeOption(this)">
                                <i class="fas fa-sun"></i>
                                <span>Morning<br>(6AM-12PM)</span>
                            </div>
                            <div class="time-option afternoon" onclick="toggleTimeOption(this)">
                                <i class="fas fa-cloud-sun"></i>
                                <span>Afternoon<br>(12PM-5PM)</span>
                            </div>
                            <div class="time-option evening selected" onclick="toggleTimeOption(this)">
                                <i class="fas fa-moon"></i>
                                <span>Evening<br>(5PM-10PM)</span>
                            </div>
                            <div class="time-option night" onclick="toggleTimeOption(this)">
                                <i class="fas fa-star"></i>
                                <span>Night<br>(10PM-6AM)</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Average hours per day: <strong id="tv-hours">4</strong> hours</label>
                        <div class="slider-container">
                            <input type="range" class="slider" min="0" max="24" value="4" oninput="updateSliderValue(this, 'tv-hours')">
                            <div class="slider-labels">
                                <span>0h</span>
                                <span>6h</span>
                                <span>12h</span>
                                <span>18h</span>
                                <span>24h</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Usage Frequency</label>
                        <select class="form-select">
                            <option value="daily" selected>Daily</option>
                            <option value="weekdays">Weekdays Only</option>
                            <option value="weekends">Weekends Only</option>
                            <option value="few-times">Few times a week</option>
                        </select>
                    </div>
                </div>

                <!-- AC Usage Pattern -->
                <div class="equipment-card">
                    <div class="equipment-header">
                        <div class="equipment-name">
                            <i class="fas fa-snowflake"></i>
                            <span>Air Conditioner (1.5HP Split)</span>
                        </div>
                        <span class="wattage-value">1,500 W</span>
                    </div>

                    <div class="form-group">
                        <label class="form-label">When do you typically use this?</label>
                        <div class="usage-time-grid">
                            <div class="time-option morning" onclick="toggleTimeOption(this)">
                                <i class="fas fa-sun"></i>
                                <span>Morning<br>(6AM-12PM)</span>
                            </div>
                            <div class="time-option afternoon selected" onclick="toggleTimeOption(this)">
                                <i class="fas fa-cloud-sun"></i>
                                <span>Afternoon<br>(12PM-5PM)</span>
                            </div>
                            <div class="time-option evening" onclick="toggleTimeOption(this)">
                                <i class="fas fa-moon"></i>
                                <span>Evening<br>(5PM-10PM)</span>
                            </div>
                            <div class="time-option night selected" onclick="toggleTimeOption(this)">
                                <i class="fas fa-star"></i>
                                <span>Night<br>(10PM-6AM)</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Average hours per day: <strong id="ac-hours">8</strong> hours</label>
                        <div class="slider-container">
                            <input type="range" class="slider" min="0" max="24" value="8" oninput="updateSliderValue(this, 'ac-hours')">
                            <div class="slider-labels">
                                <span>0h</span>
                                <span>6h</span>
                                <span>12h</span>
                                <span>18h</span>
                                <span>24h</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Refrigerator - Always On -->
                <div class="equipment-card">
                    <div class="equipment-header">
                        <div class="equipment-name">
                            <i class="fas fa-blender"></i>
                            <span>Refrigerator (Double Door)</span>
                        </div>
                        <span class="wattage-value">150 W</span>
                    </div>
                    <div class="ai-bubble" style="margin: 15px 0 0 0;">
                        <p style="font-size: 0.9rem;">ðŸ’¡ I've automatically set this to run 24/7 since refrigerators need constant power. The compressor typically runs about 8-12 hours per day in cycles.</p>
                    </div>
                </div>

                <!-- Light Bulbs - Night Usage -->
                <div class="equipment-card">
                    <div class="equipment-header">
                        <div class="equipment-name">
                            <i class="fas fa-lightbulb"></i>
                            <span>Light Bulbs (4 Ã— 9W LED)</span>
                        </div>
                        <span class="wattage-value">36 W</span>
                    </div>
                    <div class="ai-bubble" style="margin: 15px 0 0 0;">
                        <p style="font-size: 0.9rem;">ðŸ’¡ I've assumed lights are primarily used in the evening and night hours (6PM - 11PM). You can adjust below if different.</p>
                    </div>
                    <div class="form-group" style="margin-top: 15px;">
                        <label class="form-label">Average hours per day: <strong id="light-hours">5</strong> hours</label>
                        <div class="slider-container">
                            <input type="range" class="slider" min="0" max="24" value="5" oninput="updateSliderValue(this, 'light-hours')">
                        </div>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="nextStep(2)">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <button class="btn btn-primary" onclick="nextStep(4)">
                        View My Analysis <i class="fas fa-chart-bar"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- STEP 4: Energy Analysis Dashboard -->
        <div class="step-content" id="step4">
            <div class="card">
                <div class="ai-bubble">
                    <p>ðŸŽ‰ Analysis complete! Here's a comprehensive breakdown of your home's energy profile. Based on your equipment and usage patterns, here's what I found:</p>
                </div>

                <h2 class="card-title"><i class="fas fa-chart-pie"></i> Your Energy Profile</h2>

                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-icon primary">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <div class="stat-value">18.5 kWh</div>
                        <div class="stat-label">Daily Consumption</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon danger">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                        <div class="stat-value">2.8 kW</div>
                        <div class="stat-label">Peak Load</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon warning">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <div class="stat-value">0.4 kW</div>
                        <div class="stat-label">Minimum Load</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon secondary">
                            <i class="fas fa-calendar"></i>
                        </div>
                        <div class="stat-value">555 kWh</div>
                        <div class="stat-label">Monthly Estimate</div>
                    </div>
                </div>

                <!-- Consumption Breakdown -->
                <div class="breakdown-chart">
                    <h3 class="chart-title"><i class="fas fa-list"></i> Consumption by Equipment</h3>
                    
                    <div class="breakdown-item">
                        <div class="breakdown-icon"><i class="fas fa-snowflake" style="color: #3b82f6;"></i></div>
                        <div class="breakdown-info">
                            <div class="breakdown-name">Air Conditioner</div>
                            <div class="breakdown-bar">
                                <div class="breakdown-fill" style="width: 65%; background: linear-gradient(90deg, #3b82f6, #60a5fa);"></div>
                            </div>
                        </div>
                        <div class="breakdown-value">12 kWh (65%)</div>
                    </div>

                    <div class="breakdown-item">
                        <div class="breakdown-icon"><i class="fas fa-blender" style="color: #10b981;"></i></div>
                        <div class="breakdown-info">
                            <div class="breakdown-name">Refrigerator</div>
                            <div class="breakdown-bar">
                                <div class="breakdown-fill" style="width: 20%; background: linear-gradient(90deg, #10b981, #34d399);"></div>
                            </div>
                        </div>
                        <div class="breakdown-value">3.6 kWh (20%)</div>
                    </div>

                    <div class="breakdown-item">
                        <div class="breakdown-icon"><i class="fas fa-tv" style="color: #8b5cf6;"></i></div>
                        <div class="breakdown-info">
                            <div class="breakdown-name">Television</div>
                            <div class="breakdown-bar">
                                <div class="breakdown-fill" style="width: 8%; background: linear-gradient(90deg, #8b5cf6, #a78bfa);"></div>
                            </div>
                        </div>
                        <div class="breakdown-value">0.48 kWh (3%)</div>
                    </div>

                    <div class="breakdown-item">
                        <div class="breakdown-icon"><i class="fas fa-fan" style="color: #f59e0b;"></i></div>
                        <div class="breakdown-info">
                            <div class="breakdown-name">Fans (3)</div>
                            <div class="breakdown-bar">
                                <div class="breakdown-fill" style="width: 10%; background: linear-gradient(90deg, #f59e0b, #fbbf24);"></div>
                            </div>
                        </div>
                        <div class="breakdown-value">1.95 kWh (10%)</div>
                    </div>

                    <div class="breakdown-item">
                        <div class="breakdown-icon"><i class="fas fa-lightbulb" style="color: #fbbf24;"></i></div>
                        <div class="breakdown-info">
                            <div class="breakdown-name">Light Bulbs</div>
                            <div class="breakdown-bar">
                                <div class="breakdown-fill" style="width: 2%; background: linear-gradient(90deg, #fbbf24, #fcd34d);"></div>
                            </div>
                        </div>
                        <div class="breakdown-value">0.18 kWh (1%)</div>
                    </div>
                </div>

                <!-- Peak Hours Info -->
                <div class="breakdown-chart" style="margin-top: 20px;">
                    <h3 class="chart-title"><i class="fas fa-clock"></i> Peak Consumption Hours</h3>
                    <div class="ai-bubble">
                        <p>âš¡ Your highest energy usage occurs between <strong>2PM - 6PM</strong> and <strong>10PM - 2AM</strong> when your AC is running. Consider using energy-saving mode during these hours.</p>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="nextStep(3)">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <button class="btn btn-primary" onclick="nextStep(5)">
                        Calculate Costs <i class="fas fa-money-bill"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- STEP 5: Location & Power Company -->
        <div class="step-content" id="step5">
            <div class="card">
                <div class="ai-bubble">
                    <p>Now let's estimate your electricity costs! Tell me your location and power distribution company, and I'll fetch the current tariff rates to give you an accurate monthly bill estimate.</p>
                </div>

                <h2 class="card-title"><i class="fas fa-map-marker-alt"></i> Location & Utility</h2>
                <p class="card-subtitle">Select your state and power distribution company</p>

                <div class="form-group">
                    <label class="form-label">State</label>
                    <select class="form-select" id="stateSelect">
                        <option value="">Select your state</option>
                        <option value="lagos">Lagos</option>
                        <option value="abuja">Abuja (FCT)</option>
                        <option value="rivers">Rivers</option>
                        <option value="kano">Kano</option>
                        <option value="oyo">Oyo</option>
                        <option value="delta">Delta</option>
                        <option value="kaduna">Kaduna</option>
                        <option value="enugu">Enugu</option>
                        <option value="anambra">Anambra</option>
                        <option value="edo">Edo</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Distribution Company (DisCo)</label>
                    <select class="form-select" id="discoSelect">
                        <option value="">Select your DisCo</option>
                        <option value="ekedc">Eko Electricity (EKEDC)</option>
                        <option value="ikedc">Ikeja Electric (IKEDC)</option>
                        <option value="aedc">Abuja Electricity (AEDC)</option>
                        <option value="phedc">Port Harcourt Electric (PHEDC)</option>
                        <option value="kedco">Kano Electricity (KEDCO)</option>
                        <option value="ibedc">Ibadan Electricity (IBEDC)</option>
                        <option value="bedc">Benin Electricity (BEDC)</option>
                        <option value="eedc">Enugu Electricity (EEDC)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Tariff Band (if known)</label>
                    <select class="form-select" id="tariffBand">
                        <option value="">Select tariff band</option>
                        <option value="a">Band A (20+ hours supply)</option>
                        <option value="b">Band B (16-20 hours supply)</option>
                        <option value="c">Band C (12-16 hours supply)</option>
                        <option value="d">Band D (8-12 hours supply)</option>
                        <option value="e">Band E (4-8 hours supply)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Average daily power supply hours</label>
                    <div class="slider-container">
                        <input type="range" class="slider" min="0" max="24" value="12" id="powerHours" oninput="updateSliderValue(this, 'power-hours-display')">
                        <div class="slider-labels">
                            <span>0h</span>
                            <span>6h</span>
                            <span>12h</span>
                            <span>18h</span>
                            <span>24h</span>
                        </div>
                    </div>
                    <p style="text-align: center; margin-top: 10px; color: var(--primary);">
                        <strong id="power-hours-display">12</strong> hours daily
                    </p>
                </div>

                <!-- Cost Estimate Card -->
                <div class="solar-card">
                    <div class="solar-header">
                        <div class="solar-icon">ðŸ’°</div>
                        <div>
                            <h3 class="solar-title">Estimated Monthly Bill</h3>
                            <p class="solar-subtitle">Based on Band B tariff @ â‚¦225/kWh</p>
                        </div>
                    </div>
                    <div class="solar-specs">
                        <div class="spec-item">
                            <div class="spec-value">â‚¦41,625</div>
                            <div class="spec-label">With 12hrs Power</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-value">â‚¦83,250</div>
                            <div class="spec-label">With 24hrs Power</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-value">â‚¦124,875</div>
                            <div class="spec-label">If 24/7 (Band A)</div>
                        </div>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="nextStep(4)">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <button class="btn btn-primary" onclick="nextStep(6)">
                        Solar Options <i class="fas fa-solar-panel"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- STEP 6: Solar Recommendation -->
        <div class="step-content" id="step6">
            <div class="card">
                <div class="ai-bubble">
                    <p>ðŸŒž Based on your energy profile, here are my solar system recommendations. I've calculated what you'd need for both backup power and complete off-grid independence.</p>
                </div>

                <h2 class="card-title"><i class="fas fa-solar-panel"></i> Solar Recommendations</h2>
                <p class="card-subtitle">Customized based on your consumption profile</p>

                <!-- Option 1: Essential Backup -->
                <div class="solar-card">
                    <div class="solar-header">
                        <div class="solar-icon">âš¡</div>
                        <div>
                            <h3 class="solar-title">Essential Backup System</h3>
                            <p class="solar-subtitle">Powers lights, fans, TV, and phone charging</p>
                        </div>
                    </div>
                    <div class="solar-specs">
                        <div class="spec-item">
                            <div class="spec-value">1.5 kVA</div>
                            <div class="spec-label">Inverter Size</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-value">2 Ã— 200Ah</div>
                            <div class="spec-label">Battery Bank</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-value">4 Ã— 300W</div>
                            <div class="spec-label">Solar Panels</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-value">~â‚¦850K</div>
                            <div class="spec-label">Est. Cost</div>
                        </div>
                    </div>
                </div>

                <!-- Option 2: Full Load -->
                <div class="solar-card" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1)); border-color: rgba(59, 130, 246, 0.3);">
                    <div class="solar-header">
                        <div class="solar-icon" style="background: rgba(59, 130, 246, 0.2);">ðŸ”‹</div>
                        <div>
                            <h3 class="solar-title">Full Home Power System</h3>
                            <p class="solar-subtitle">Powers everything including AC & refrigerator</p>
                        </div>
                    </div>
                    <div class="solar-specs">
                        <div class="spec-item">
                            <div class="spec-value" style="color: #3b82f6;">5 kVA</div>
                            <div class="spec-label">Inverter Size</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-value" style="color: #3b82f6;">4 Ã— 200Ah</div>
                            <div class="spec-label">Battery Bank</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-value" style="color: #3b82f6;">10 Ã— 450W</div>
                            <div class="spec-label">Solar Panels</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-value" style="color: #3b82f6;">~â‚¦3.2M</div>
                            <div class="spec-label">Est. Cost</div>
                        </div>
                    </div>
                </div>

                <!-- Key Insights -->
                <div class="breakdown-chart">
                    <h3 class="chart-title"><i class="fas fa-info-circle"></i> Key Insights</h3>
                    <ul style="list-style: none; padding: 0;">
                        <li style="padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <i class="fas fa-check-circle" style="color: var(--success); margin-right: 10px;"></i>
                            Your AC accounts for 65% of consumption - consider an inverter AC to reduce this
                        </li>
                        <li style="padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <i class="fas fa-check-circle" style="color: var(--success); margin-right: 10px;"></i>
                            ROI on full system: ~3-4 years based on current electricity costs
                        </li>
                        <li style="padding: 10px 0;">
                            <i class="fas fa-check-circle" style="color: var(--success); margin-right: 10px;"></i>
                            Lithium batteries recommended for longer lifespan (10+ years)
                        </li>
                    </ul>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="nextStep(5)">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <button class="btn btn-primary" onclick="nextStep(7)">
                        Get My Report <i class="fas fa-file-pdf"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- STEP 7: Get Report (Collect User Details) -->
        <div class="step-content" id="step7">
            <div class="card">
                <div class="ai-bubble">
                    <p>ðŸŽŠ Congratulations! Your personalized energy report is ready. Enter your details below and I'll send you a comprehensive PDF report with all the analysis, recommendations, and a detailed equipment breakdown.</p>
                </div>

                <h2 class="card-title"><i class="fas fa-file-alt"></i> Get Your Free Report</h2>
                <p class="card-subtitle">We'll email you a detailed PDF with all insights</p>

                <div class="form-group">
                    <label class="form-label">Full Name</label>
                    <input type="text" class="form-input" placeholder="Enter your full name">
                </div>

                <div class="form-group">
                    <label class="form-label">Email Address</label>
                    <input type="email" class="form-input" placeholder="Enter your email address">
                </div>

                <div class="form-group">
                    <label class="form-label">Phone Number</label>
                    <input type="tel" class="form-input" placeholder="Enter your phone number">
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" style="margin-right: 10px;">
                        I'm interested in getting a quote from solar installers
                    </label>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" style="margin-right: 10px;">
                        Send me energy saving tips and updates
                    </label>
                </div>

                <!-- Report Preview -->
                <div class="solar-card">
                    <h3 style="margin-bottom: 15px;">ðŸ“‹ Your Report Includes:</h3>
                    <ul style="list-style: none; padding: 0;">
                        <li style="padding: 8px 0;">âœ… Complete equipment inventory with wattages</li>
                        <li style="padding: 8px 0;">âœ… Daily, weekly, and monthly consumption estimates</li>
                        <li style="padding: 8px 0;">âœ… Peak usage hours analysis</li>
                        <li style="padding: 8px 0;">âœ… Electricity cost projections</li>
                        <li style="padding: 8px 0;">âœ… Solar system recommendations & sizing</li>
                        <li style="padding: 8px 0;">âœ… Energy-saving tips for your home</li>
                    </ul>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="nextStep(6)">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <button class="btn btn-primary" style="flex: 1;" onclick="submitForm()">
                        <i class="fas fa-paper-plane"></i> Send My Report
                    </button>
                </div>
            </div>
        </div>

    </div>

    <script>
    // Current step tracker
    let currentStep = 1;
    const totalSteps = 7;

    // Equipment database (sample - would be much larger in production)
    const equipmentDatabase = {
        tv: {
            samsung: { 32: { led: 35, smart: 40 }, 43: { led: 55, smart: 60 }, 55: { led: 80, smart: 90, qled: 120 }, 65: { led: 100, smart: 120, qled: 150 } },
            lg: { 32: { led: 33, smart: 38 }, 43: { led: 50, smart: 58 }, 55: { led: 75, smart: 85, oled: 130 }, 65: { led: 95, smart: 110, oled: 160 } },
            sony: { 43: { led: 60, smart: 70 }, 55: { led: 90, smart: 100, oled: 140 }, 65: { led: 110, smart: 130, oled: 170 } },
            hisense: { 32: { led: 30, smart: 35 }, 43: { led: 45, smart: 50 }, 55: { led: 70, smart: 80 } },
            tcl: { 32: { led: 28, smart: 33 }, 43: { led: 42, smart: 48 }, 55: { led: 65, smart: 75 } },
            other: { 32: { led: 35, smart: 40 }, 43: { led: 55, smart: 60 }, 55: { led: 80, smart: 90 }, 65: { led: 100, smart: 120 } }
        },
        ac: {
            split: { '1': 900, '1.5': 1350, '2': 1800, '2.5': 2250 },
            window: { '1': 1000, '1.5': 1500, '2': 2000 },
            inverter: { '1': 600, '1.5': 900, '2': 1200, '2.5': 1500 },
            portable: { '1': 1100, '1.5': 1650 }
        },
        fan: {
            ceiling: 75,
            standing: 65,
            table: 45,
            exhaust: 40
        },
        refrigerator: {
            'single-door': { '100': 80, '200': 100, '300': 120 },
            'double-door': { '200': 150, '300': 180, '400': 200, '500': 250 },
            'side-by-side': { '400': 250, '500': 300 },
            'mini': { '100': 60 },
            'inverter': { '200': 80, '300': 100, '400': 120 }
        },
        microwave: {
            small: 800,
            medium: 1000,
            large: 1200
        },
        washingMachine: {
            'top-load': { manual: 350, automatic: 500 },
            'front-load': { automatic: 500, inverter: 300 }
        },
        waterHeater: {
            instant: 3000,
            storage: { '25': 1500, '50': 2000, '100': 3000 }
        },
        iron: {
            dry: 1000,
            steam: 1400,
            cordless: 1800
        },
        blender: {
            small: 300,
            medium: 500,
            large: 800
        },
        electricKettle: {
            small: 1500,
            medium: 1800,
            large: 2200
        },
        desktopComputer: 250,
        laptop: 65,
        router: 12,
        decoder: 25,
        charger: 10,
        securityLight: 30,
        waterPump: {
            '0.5hp': 370,
            '1hp': 750,
            '1.5hp': 1100,
            '2hp': 1500
        }
    };

    // Store user selections
    let userSelections = {
        houseType: null,
        equipment: [],
        usagePatterns: {},
        location: {},
        contactInfo: {},
        energyProfile: null
    };

    // Helper function to safely get nested object values
    function safeGet(obj, ...keys) {
        return keys.reduce((acc, key) => {
            if (acc && typeof acc === 'object' && key in acc) {
                return acc[key];
            }
            return undefined;
        }, obj);
    }

    // Navigation function
    function nextStep(step) {
        const currentStepElement = document.getElementById(`step${currentStep}`);
        const nextStepElement = document.getElementById(`step${step}`);
        
        // Validate elements exist
        if (!currentStepElement || !nextStepElement) {
            console.error(`Step element not found: step${currentStep} or step${step}`);
            return;
        }
        
        // Hide current step
        currentStepElement.classList.remove('active');
        
        // Show new step
        nextStepElement.classList.add('active');
        
        // Update progress bar
        const progressFill = document.getElementById('progressFill');
        if (progressFill) {
            const progress = (step / totalSteps) * 100;
            progressFill.style.width = `${progress}%`;
        }
        
        // Update step circles
        updateStepCircles(step);
        
        // Update current step tracker
        currentStep = step;
        
        // Scroll to top
        window.scrollTo({ top: 0, behavior: 'smooth' });

        // If moving to analysis step, calculate results
        if (step === 4) {
            calculateEnergyProfile();
        }
    }

    // Go to previous step
    function prevStep() {
        if (currentStep > 1) {
            nextStep(currentStep - 1);
        }
    }

    // Update step circles in progress bar
    function updateStepCircles(activeStep) {
        const circles = document.querySelectorAll('.step-circle');
        circles.forEach((circle, index) => {
            const stepNum = index + 1;
            circle.classList.remove('active', 'completed');
            
            if (stepNum < activeStep) {
                circle.classList.add('completed');
                circle.innerHTML = '<i class="fas fa-check"></i>';
            } else if (stepNum === activeStep) {
                circle.classList.add('active');
                circle.textContent = stepNum;
            } else {
                circle.textContent = stepNum;
            }
        });
    }

    // House type selection - using event delegation
    function initHouseTypeSelection() {
        const container = document.querySelector('.house-options-container') || document.body;
        
        container.addEventListener('click', function(e) {
            const option = e.target.closest('.house-option');
            if (!option) return;
            
            // Remove selected class from all options
            document.querySelectorAll('.house-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Add selected class to clicked option
            option.classList.add('selected');
            
            // Store selection
            userSelections.houseType = option.dataset.value;
            
            // Auto-populate rooms based on house type
            updateRoomsBasedOnHouseType(option.dataset.value);
        });
    }

    // Update rooms based on house type
    function updateRoomsBasedOnHouseType(houseType) {
        const roomConfigs = {
            'self-contain': ['Living Area', 'Bathroom'],
            '1-room-parlor': ['Living Room', 'Bedroom', 'Kitchen', 'Bathroom'],
            '2-bedroom': ['Living Room', 'Bedroom 1', 'Bedroom 2', 'Kitchen', 'Bathroom'],
            '3-bedroom': ['Living Room', 'Bedroom 1', 'Bedroom 2', 'Bedroom 3', 'Kitchen', 'Bathroom', 'General'],
            '4-bedroom': ['Living Room', 'Bedroom 1', 'Bedroom 2', 'Bedroom 3', 'Bedroom 4', 'Kitchen', 'Bathroom', 'General'],
            'duplex': ['Living Room', 'Master Bedroom', 'Bedroom 2', 'Bedroom 3', 'Bedroom 4', 'Kitchen', 'Dining', 'Bathroom 1', 'Bathroom 2', 'General'],
            'bungalow': ['Living Room', 'Bedroom 1', 'Bedroom 2', 'Bedroom 3', 'Kitchen', 'Bathroom', 'General'],
            'office': ['Reception', 'Office 1', 'Office 2', 'Conference Room', 'Kitchen', 'Bathroom']
        };

        const rooms = roomConfigs[houseType] || [];
        console.log('Rooms for', houseType, ':', rooms);
        
        // You can dynamically update room tabs here
        // Example: updateRoomTabs(rooms);
    }

    // Toggle equipment on/off
    function toggleEquipment(toggleElement) {
        if (!toggleElement) return;
        
        toggleElement.classList.toggle('active');
        const card = toggleElement.closest('.equipment-card');
        if (!card) return;
        
        const detailsSection = card.querySelector('.equipment-details');
        
        if (detailsSection) {
            if (toggleElement.classList.contains('active')) {
                detailsSection.classList.add('show');
            } else {
                detailsSection.classList.remove('show');
            }
        }
        
        // Recalculate when toggling
        updateEquipmentWattage(card);
    }

    // Update quantity with stepper buttons
    function updateQuantity(button, change) {
        if (!button) return;
        
        const stepper = button.closest('.quantity-stepper');
        if (!stepper) return;
        
        const valueDisplay = stepper.querySelector('.stepper-value');
        if (!valueDisplay) return;
        
        let currentValue = parseInt(valueDisplay.textContent) || 1;
        currentValue = Math.max(1, currentValue + change); // Minimum of 1
        valueDisplay.textContent = currentValue;
        
        // Recalculate wattage
        const card = button.closest('.equipment-card');
        if (card) {
            // Check if it's custom equipment
            const customInput = card.querySelector('input[type="number"][placeholder="Enter watts"]');
            if (customInput) {
                updateCustomWattage(customInput);
            } else {
                updateEquipmentWattage(card);
            }
        }
    }

    // Update slider value display
    function updateSliderValue(slider, displayId) {
        const display = document.getElementById(displayId);
        if (display && slider) {
            display.textContent = slider.value;
        }
    }

    // Toggle time option selection
    function toggleTimeOption(element) {
        if (element) {
            element.classList.toggle('selected');
        }
    }

    // Room tab navigation - using event delegation
    function initRoomTabs() {
        const tabsContainer = document.querySelector('.room-tabs') || document.body;
        
        tabsContainer.addEventListener('click', function(e) {
            const tab = e.target.closest('.room-tab');
            if (!tab) return;
            
            // Update active tab
            document.querySelectorAll('.room-tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            
            // Show corresponding room content
            const roomId = tab.dataset.room;
            document.querySelectorAll('.room-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const roomContent = document.getElementById(`room-${roomId}`);
            if (roomContent) {
                roomContent.classList.add('active');
            }
        });
    }

    // Update wattage based on selections
    function updateWattage(selectElement) {
        if (!selectElement) return;
        
        const card = selectElement.closest('.equipment-card');
        if (card) {
            updateEquipmentWattage(card);
        }
    }

    // Calculate and update equipment wattage
    function updateEquipmentWattage(card) {
        if (!card) return 0;
        
        const nameElement = card.querySelector('.equipment-name span');
        if (!nameElement) return 0;
        
        const equipmentName = nameElement.textContent.toLowerCase().trim();
        const selects = card.querySelectorAll('.detail-select');
        
        let wattage = 0;
        
        // Get selected values with normalized keys
        const values = {};
        selects.forEach(select => {
            const labelElement = select.closest('.detail-group')?.querySelector('.detail-label');
            if (labelElement) {
                // Normalize label: lowercase, remove special chars except hyphens
                const label = labelElement.textContent.toLowerCase()
                    .replace(/[()]/g, '')
                    .replace(/\s+/g, ' ')
                    .trim();
                values[label] = select.value;
            }
        });
        
        // Get quantity
        const quantityElement = card.querySelector('.stepper-value');
        const quantity = quantityElement ? parseInt(quantityElement.textContent) || 1 : 1;
        
        // Calculate wattage based on equipment type
        try {
            if (equipmentName.includes('television') || equipmentName.includes('tv')) {
                const brand = values['brand'] || 'other';
                const size = parseInt(values['size']) || 43;
                const type = values['type'] || 'led';
                
                wattage = safeGet(equipmentDatabase, 'tv', brand, size, type) || 
                         safeGet(equipmentDatabase, 'tv', 'other', size, type) || 60;
                         
            } else if (equipmentName.includes('air conditioner') || equipmentName.includes('ac')) {
                const type = values['type'] || 'split';
                const capacity = values['capacity'] || '1.5';
                
                wattage = safeGet(equipmentDatabase, 'ac', type, capacity) || 1350;
                
            } else if (equipmentName.includes('fan')) {
                const type = values['type'] || 'ceiling';
                wattage = safeGet(equipmentDatabase, 'fan', type) || 65;
                
            } else if (equipmentName.includes('refrigerator') || equipmentName.includes('fridge')) {
                const type = values['type'] || 'double-door';
                // Handle various label formats for size
                const size = values['size litres'] || values['size'] || '200';
                
                wattage = safeGet(equipmentDatabase, 'refrigerator', type, size) || 150;
                
            } else if (equipmentName.includes('microwave')) {
                const size = values['size'] || 'medium';
                wattage = safeGet(equipmentDatabase, 'microwave', size) || 1000;
                
            } else if (equipmentName.includes('washing machine')) {
                const type = values['type'] || 'top-load';
                const subType = values['load type'] || 'automatic';
                wattage = safeGet(equipmentDatabase, 'washingMachine', type, subType) || 500;
                
            } else if (equipmentName.includes('water heater') || equipmentName.includes('heater')) {
                const type = values['type'] || 'instant';
                if (type === 'instant') {
                    wattage = equipmentDatabase.waterHeater.instant;
                } else {
                    const size = values['size'] || '50';
                    wattage = safeGet(equipmentDatabase, 'waterHeater', 'storage', size) || 2000;
                }
                
            } else if (equipmentName.includes('iron')) {
                const type = values['type'] || 'steam';
                wattage = safeGet(equipmentDatabase, 'iron', type) || 1000;
                
            } else if (equipmentName.includes('blender')) {
                const size = values['size'] || 'medium';
                wattage = safeGet(equipmentDatabase, 'blender', size) || 500;
                
            } else if (equipmentName.includes('kettle')) {
                const size = values['size'] || 'medium';
                wattage = safeGet(equipmentDatabase, 'electricKettle', size) || 1800;
                
            } else if (equipmentName.includes('desktop') || equipmentName.includes('computer')) {
                wattage = equipmentDatabase.desktopComputer || 250;
                
            } else if (equipmentName.includes('laptop')) {
                wattage = equipmentDatabase.laptop || 65;
                
            } else if (equipmentName.includes('router') || equipmentName.includes('wifi')) {
                wattage = equipmentDatabase.router || 12;
                
            } else if (equipmentName.includes('decoder') || equipmentName.includes('dstv')) {
                wattage = equipmentDatabase.decoder || 25;
                
            } else if (equipmentName.includes('charger') || equipmentName.includes('phone')) {
                wattage = equipmentDatabase.charger || 10;
                
            } else if (equipmentName.includes('security') || equipmentName.includes('flood light')) {
                wattage = equipmentDatabase.securityLight || 30;
                
            } else if (equipmentName.includes('pump') || equipmentName.includes('water pump')) {
                const hp = values['horsepower'] || values['hp'] || '1hp';
                wattage = safeGet(equipmentDatabase, 'waterPump', hp) || 750;
                
            } else {
                // Default fallback
                wattage = 50;
            }
        } catch (error) {
            console.error('Error calculating wattage:', error);
            wattage = 50; // Default fallback
        }
        
        // Apply quantity
        const totalWattage = wattage * quantity;
        
        // Update display
        const wattageDisplay = card.querySelector('.wattage-value');
        if (wattageDisplay) {
            wattageDisplay.textContent = `${totalWattage.toLocaleString()} W`;
        }
        
        return totalWattage;
    }

    // Calculate energy profile for analysis
    function calculateEnergyProfile() {
        let totalDailyConsumption = 0;
        let peakLoad = 0;
        let equipmentBreakdown = [];
        
        // Get all active equipment
        document.querySelectorAll('.equipment-card').forEach(card => {
            const toggle = card.querySelector('.equipment-toggle');
            if (toggle && toggle.classList.contains('active')) {
                const nameElement = card.querySelector('.equipment-name span, .equipment-name input');
                const name = nameElement ? (nameElement.value || nameElement.textContent || 'Unknown') : 'Unknown';
                
                const wattageElement = card.querySelector('.wattage-value');
                const wattageText = wattageElement ? wattageElement.textContent : '0';
                const wattage = parseInt(wattageText.replace(/[^0-9]/g, '')) || 0;
                
                // Estimate hours based on equipment type
                let hours = getEstimatedHours(name.toLowerCase());
                
                const dailyKwh = (wattage * hours) / 1000;
                
                equipmentBreakdown.push({
                    name: name,
                    wattage: wattage,
                    hours: hours,
                    dailyKwh: dailyKwh
                });
                
                totalDailyConsumption += dailyKwh;
                peakLoad += wattage;
            }
        });
        
        // Update dashboard displays if they exist
        updateDashboard(totalDailyConsumption, peakLoad);
        
        // Store for later use
        userSelections.energyProfile = {
            dailyConsumption: totalDailyConsumption,
            peakLoad: peakLoad,
            monthlyEstimate: totalDailyConsumption * 30,
            breakdown: equipmentBreakdown
        };
        
        console.log('Energy Profile:', userSelections.energyProfile);
        
        return userSelections.energyProfile;
    }

    // Get estimated hours based on equipment type
    function getEstimatedHours(equipmentName) {
        const hoursMap = {
            'refrigerator': 8,
            'fridge': 8,
            'freezer': 10,
            'light': 5,
            'bulb': 5,
            'lamp': 4,
            'ac': 8,
            'air conditioner': 8,
            'fan': 10,
            'tv': 6,
            'television': 6,
            'router': 24,
            'wifi': 24,
            'decoder': 6,
            'microwave': 0.5,
            'kettle': 0.3,
            'iron': 0.5,
            'washing': 1,
            'blender': 0.2,
            'charger': 3,
            'phone': 3,
            'laptop': 6,
            'computer': 8,
            'desktop': 8,
            'pump': 2,
            'heater': 2,
            'security': 12
        };
        
        for (const [key, hours] of Object.entries(hoursMap)) {
            if (equipmentName.includes(key)) {
                return hours;
            }
        }
        
        return 4; // Default hours
    }

    // Update dashboard displays
    function updateDashboard(dailyKwh, peakWatts) {
        const dailyElement = document.getElementById('dailyConsumption');
        const peakElement = document.getElementById('peakLoad');
        const monthlyElement = document.getElementById('monthlyConsumption');
        
        if (dailyElement) dailyElement.textContent = `${dailyKwh.toFixed(2)} kWh`;
        if (peakElement) peakElement.textContent = `${(peakWatts / 1000).toFixed(2)} kW`;
        if (monthlyElement) monthlyElement.textContent = `${(dailyKwh * 30).toFixed(0)} kWh`;
    }

    // Calculate electricity cost
    function calculateElectricityCost() {
        const tariffRates = {
            a: 225, // Band A - â‚¦225/kWh
            b: 63,  // Band B - â‚¦63/kWh
            c: 53,  // Band C - â‚¦53/kWh
            d: 48,  // Band D - â‚¦48/kWh
            e: 43   // Band E - â‚¦43/kWh
        };
        
        const bandElement = document.getElementById('tariffBand');
        const hoursElement = document.getElementById('powerHours');
        
        const band = bandElement ? bandElement.value : 'b';
        const powerHours = hoursElement ? parseInt(hoursElement.value) || 12 : 12;
        const rate = tariffRates[band] || tariffRates.b;
        
        const profile = userSelections.energyProfile || { monthlyEstimate: 555 };
        
        // Adjust consumption based on power supply hours
        const adjustedMonthly = (profile.monthlyEstimate / 24) * powerHours;
        const monthlyCost = adjustedMonthly * rate;
        
        return {
            monthlyKwh: adjustedMonthly,
            monthlyCost: monthlyCost,
            rate: rate,
            band: band.toUpperCase()
        };
    }

    // Calculate solar system requirements
    function calculateSolarRequirements() {
        const profile = userSelections.energyProfile || { 
            dailyConsumption: 18.5, 
            peakLoad: 2800 
        };
        
        const dailyKwh = profile.dailyConsumption;
        const peakKw = profile.peakLoad / 1000;
        
        // Inverter sizing (1.25x peak load for safety margin)
        const inverterSize = Math.ceil(peakKw * 1.25);
        
        // Battery sizing (for 8-12 hours backup)
        const backupHours = 8;
        const batteryVoltage = 48;
        const dod = 0.5; // Depth of Discharge
        const efficiency = 0.85;
        
        const batteryAh = (dailyKwh * 1000 * (backupHours / 24)) / (batteryVoltage * dod * efficiency);
        const batteriesNeeded = Math.ceil(batteryAh / 200); // 200Ah batteries
        
        // Solar panel sizing
        const peakSunHours = 5; // Nigeria average
        const systemEfficiency = 0.8;
        
        const panelKw = dailyKwh / (peakSunHours * systemEfficiency);
        const panelsNeeded = Math.ceil((panelKw * 1000) / 450); // 450W panels
        
        const solarRecommendation = {
            inverterKva: Math.max(1, inverterSize),
            batteries: {
                count: Math.max(1, batteriesNeeded),
                size: '200Ah',
                voltage: '48V'
            },
            panels: {
                count: Math.max(1, panelsNeeded),
                size: '450W',
                totalKw: ((Math.max(1, panelsNeeded)) * 450) / 1000
            },
            estimatedCost: calculateSystemCost(
                Math.max(1, inverterSize), 
                Math.max(1, batteriesNeeded), 
                Math.max(1, panelsNeeded)
            )
        };
        
        return solarRecommendation;
    }

    // Estimate solar system cost
    function calculateSystemCost(inverterKva, batteries, panels) {
        // Nigerian market estimates (2024)
        const inverterPricePerKva = 150000;
        const batteryPrice = 250000;
        const panelPrice = 120000;
        const installationPercent = 0.15;
        
        const equipmentCost = (inverterKva * inverterPricePerKva) + 
                              (batteries * batteryPrice) + 
                              (panels * panelPrice);
        
        const installationCost = equipmentCost * installationPercent;
        const totalCost = equipmentCost + installationCost;
        
        return {
            equipment: equipmentCost,
            installation: installationCost,
            total: totalCost,
            formatted: {
                equipment: formatCurrency(equipmentCost),
                installation: formatCurrency(installationCost),
                total: formatCurrency(totalCost)
            }
        };
    }

    // Format currency
    function formatCurrency(amount) {
        return 'â‚¦' + amount.toLocaleString('en-NG');
    }

    // Add custom equipment
    function addCustomEquipment(roomId) {
        const template = `
            <div class="equipment-card custom-equipment">
                <div class="equipment-header">
                    <div class="equipment-name">
                        <i class="fas fa-plug"></i>
                        <input type="text" class="detail-input custom-name-input" 
                               placeholder="Equipment name" 
                               style="background: transparent; border: none; border-bottom: 1px solid rgba(255,255,255,0.3); 
                                      font-weight: 600; color: inherit; width: 150px; padding: 5px;">
                    </div>
                    <div class="equipment-toggle active" onclick="toggleEquipment(this)"></div>
                </div>
                <div class="equipment-details show">
                    <div class="detail-group">
                        <label class="detail-label">Power Rating (W)</label>
                        <input type="number" class="detail-input custom-wattage-input" 
                               placeholder="Enter watts" min="1" max="10000"
                               onchange="updateCustomWattage(this)" 
                               oninput="updateCustomWattage(this)">
                    </div>
                    <div class="detail-group">
                        <label class="detail-label">Quantity</label>
                        <div class="quantity-stepper">
                            <button type="button" class="stepper-btn" onclick="updateQuantity(this, -1)">-</button>
                            <span class="stepper-value">1</span>
                            <button type="button" class="stepper-btn" onclick="updateQuantity(this, 1)">+</button>
                        </div>
                    </div>
                    <div class="detail-group">
                        <label class="detail-label">Hours/Day</label>
                        <input type="number" class="detail-input custom-hours-input" 
                               placeholder="Hours" min="0.1" max="24" step="0.5" value="4">
                    </div>
                    <div class="wattage-display" style="grid-column: 1 / -1;">
                        <span class="wattage-label">Total Power Rating</span>
                        <span class="wattage-value">-- W</span>
                    </div>
                </div>
                <button type="button" class="btn btn-secondary remove-btn" 
                        style="margin-top: 10px; padding: 8px 15px; font-size: 0.8rem;" 
                        onclick="removeEquipment(this)">
                    <i class="fas fa-trash"></i> Remove
                </button>
            </div>
        `;
        
        const roomContent = document.getElementById(`room-${roomId}`) || 
                           document.querySelector('.room-content.active');
        
        if (!roomContent) {
            console.error('Room content not found');
            return;
        }
        
        const addButton = roomContent.querySelector('.add-equipment-btn');
        if (addButton) {
            addButton.insertAdjacentHTML('beforebegin', template);
        } else {
            roomContent.insertAdjacentHTML('beforeend', template);
        }
    }

    // Update custom equipment wattage
    function updateCustomWattage(input) {
        if (!input) return;
        
        const card = input.closest('.equipment-card');
        if (!card) return;
        
        const wattageInput = card.querySelector('.custom-wattage-input');
        const wattage = wattageInput ? (parseInt(wattageInput.value) || 0) : 0;
        
        const quantityElement = card.querySelector('.stepper-value');
        const quantity = quantityElement ? (parseInt(quantityElement.textContent) || 1) : 1;
        
        const totalWattage = wattage * quantity;
        
        const wattageDisplay = card.querySelector('.wattage-value');
        if (wattageDisplay) {
            wattageDisplay.textContent = totalWattage > 0 ? 
                `${totalWattage.toLocaleString()} W` : '-- W';
        }
    }

    // Remove equipment
    function removeEquipment(button) {
        if (!button) return;
        
        const card = button.closest('.equipment-card');
        if (card) {
            // Add fade out animation
            card.style.transition = 'opacity 0.3s, transform 0.3s';
            card.style.opacity = '0';
            card.style.transform = 'scale(0.9)';
            
            setTimeout(() => card.remove(), 300);
        }
    }

    // Initialize add equipment buttons
    function initAddEquipmentButtons() {
        document.addEventListener('click', function(e) {
            const btn = e.target.closest('.add-equipment-btn');
            if (!btn) return;
            
            const roomContent = btn.closest('.room-content');
            const roomId = roomContent ? roomContent.id.replace('room-', '') : 'living';
            addCustomEquipment(roomId);
        });
    }

    // Form validation
    function validateForm() {
        const name = document.querySelector('input[placeholder="Enter your full name"]');
        const email = document.querySelector('input[placeholder="Enter your email address"]');
        const phone = document.querySelector('input[placeholder="Enter your phone number"]');
        
        const errors = [];
        
        if (!name || !name.value.trim()) {
            errors.push('Please enter your name');
        }
        
        if (!email || !email.value.trim()) {
            errors.push('Please enter your email');
        } else {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email.value.trim())) {
                errors.push('Please enter a valid email address');
            }
        }
        
        if (!phone || !phone.value.trim()) {
            errors.push('Please enter your phone number');
        } else {
            const phoneRegex = /^[\d\s+()-]{10,}$/;
            if (!phoneRegex.test(phone.value.trim())) {
                errors.push('Please enter a valid phone number');
            }
        }
        
        return errors;
    }

    // Form submission
    function submitForm() {
        const errors = validateForm();
        
        if (errors.length > 0) {
            alert(errors.join('\n'));
            return;
        }
        
        const name = document.querySelector('input[placeholder="Enter your full name"]').value.trim();
        const email = document.querySelector('input[placeholder="Enter your email address"]').value.trim();
        const phone = document.querySelector('input[placeholder="Enter your phone number"]').value.trim();
        
        // Store contact info
        userSelections.contactInfo = { name, email, phone };
        
        // Compile all data
        const reportData = {
            ...userSelections,
            energyProfile: calculateEnergyProfile(),
            costEstimate: calculateElectricityCost(),
            solarRecommendation: calculateSolarRequirements(),
            timestamp: new Date().toISOString()
        };
        
        console.log('Report Data:', reportData);
        
        // Show loading state
        showLoadingState();
        
        // Simulate API call
        setTimeout(() => {
            showSuccessMessage(reportData);
        }, 1500);
        
        // In production:
        // sendReportToBackend(reportData);
    }

    // Show loading state
    function showLoadingState() {
        const step7 = document.getElementById('step7');
        if (!step7) return;
        
        step7.innerHTML = `
            <div class="card" style="text-align: center; padding: 60px 20px;">
                <div class="loading-spinner" style="margin: 0 auto 20px;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 3rem; color: var(--primary, #4CAF50);"></i>
                </div>
                <h3>Generating your report...</h3>
                <p style="color: var(--gray, #888);">Please wait while we analyze your energy profile</p>
            </div>
        `;
    }

    // Show success message
    function showSuccessMessage(reportData) {
        const step7 = document.getElementById('step7');
        if (!step7) return;
        
        const solarCost = reportData?.solarRecommendation?.estimatedCost?.formatted?.total || 'â‚¦0';
        const monthlyKwh = reportData?.energyProfile?.monthlyEstimate?.toFixed(0) || '0';
        
        step7.innerHTML = `
            <div class="card" style="text-align: center;">
                <div style="font-size: 4rem; margin-bottom: 20px;">ðŸŽ‰</div>
                <h2 class="card-title" style="justify-content: center;">Report Sent Successfully!</h2>
                <p class="card-subtitle">Check your email for your personalized energy report</p>
                
                <div class="ai-bubble" style="background: rgba(76, 175, 80, 0.1); border-radius: 15px; padding: 20px; margin: 20px 0;">
                    <p>Thank you for using EnergiX! Your comprehensive energy report has been sent to your email. It includes:</p>
                    <ul style="text-align: left; margin-top: 15px; list-style: none; padding: 0;">
                        <li style="padding: 8px 0;">âœ… Complete equipment analysis</li>
                        <li style="padding: 8px 0;">âœ… Daily & monthly consumption: <strong>${monthlyKwh} kWh/month</strong></li>
                        <li style="padding: 8px 0;">âœ… Cost projections</li>
                        <li style="padding: 8px 0;">âœ… Solar system recommendation: <strong>${solarCost}</strong></li>
                    </ul>
                </div>
                
                <div class="solar-card" style="background: rgba(255, 193, 7, 0.1); border-radius: 15px; padding: 25px; margin-top: 20px;">
                    <h3 style="margin-bottom: 15px;">ðŸ“ž Want to speak with an expert?</h3>
                    <p style="color: var(--gray, #888); margin-bottom: 20px;">Our energy consultants can help you choose the right solar solution</p>
                    <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="location.reload()">
                            <i class="fas fa-redo"></i> Start New Analysis
                        </button>
                        <button class="btn btn-secondary" onclick="window.print()">
                            <i class="fas fa-print"></i> Print Report
                        </button>
                    </div>
                </div>
            </div>
        `;
        
        // Update progress to 100%
        const progressFill = document.getElementById('progressFill');
        if (progressFill) {
            progressFill.style.width = '100%';
        }
    }

    // Send report to backend
    async function sendReportToBackend(data) {
        try {
            showLoadingState();
            
            const response = await fetch('/api/submit-report', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });
            
            if (response.ok) {
                const result = await response.json();
                showSuccessMessage(data);
            } else {
                throw new Error('Server error');
            }
        } catch (error) {
            console.error('Error:', error);
            alert('Error submitting report. Please try again.');
            
            // Restore form
            nextStep(7);
        }
    }

    // Animate on scroll
    function animateOnScroll() {
        const elements = document.querySelectorAll('.equipment-card, .stat-card, .breakdown-item');
        
        if ('IntersectionObserver' in window) {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });
            
            elements.forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                observer.observe(el);
            });
        } else {
            // Fallback for older browsers
            elements.forEach(el => {
                el.style.opacity = '1';
                el.style.transform = 'translateY(0)';
            });
        }
    }

    // Initialize all room content visibility
    function initRoomContent() {
        const roomContents = document.querySelectorAll('.room-content');
        roomContents.forEach((content, index) => {
            if (index === 0) {
                content.classList.add('active');
            } else {
                content.classList.remove('active');
            }
        });
    }

    // Initialize select change handlers using event delegation
    function initSelectHandlers() {
        document.addEventListener('change', function(e) {
            if (e.target.matches('.detail-select')) {
                updateWattage(e.target);
            }
        });
    }

    // Main initialization
    function init() {
        console.log('Initializing EnergiX...');
        
        // Initialize all components
        initHouseTypeSelection();
        initRoomTabs();
        initAddEquipmentButtons();
        initSelectHandlers();
        initRoomContent();
        animateOnScroll();
        
        // Update all equipment wattages on load
        document.querySelectorAll('.equipment-card').forEach(card => {
            const toggle = card.querySelector('.equipment-toggle');
            if (toggle && toggle.classList.contains('active')) {
                updateEquipmentWattage(card);
            }
        });
        
        console.log('EnergiX initialized successfully!');
    }

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }

    // Export functions for global access (if needed)
    window.EnergiX = {
        nextStep,
        prevStep,
        toggleEquipment,
        updateQuantity,
        updateSliderValue,
        toggleTimeOption,
        updateWattage,
        addCustomEquipment,
        updateCustomWattage,
        removeEquipment,
        submitForm,
        calculateEnergyProfile,
        calculateElectricityCost,
        calculateSolarRequirements
    };
</script>

</body>
</html>
